<!-- <?php
include '';

?> -->
<!doctype html>
<html lang="en">

<head>
    <title>patient_in_process</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>


    <style>
        /* table,
        tr,
        td {
            border: 5px solid bisque;
        } */
        button{
            border-radius: 34px;
            border: none;
        }
        .btn-consulting:visited, .btn-consulting:active{
            background-color: yellow;
        }
    </style>

</head>

<body>

    <section class="container-fluid select-data">
        <div class="container">
            <h2 class="text-center">Active Patient</h2>
            <table class="table text-center" id="">
                <thead class="text-center">
                    <tr>
                        <td>PATIENTNO</td>
                        <td></td>
                        <td>DATE</td>
                        <td></td>
                        <td>OPD NO</td>
                        <td></td>
                        <td>NAME</td>
                        <td>CONSULTATION</td>
                        <td>MEDICINE</td>
                        <td>LAB</td>
                        <td>OTHER</td>
                        <td>Bill</td>
                        <td>X</td>
                    </tr>
                <tbody id="id-table" class="text-center"></tbody>
                </thead>
            </table>

        </div>
    </section>


    <script>

        $(document).ready(function () {

            //page load fetch all data
            function pageload() {

                $("#id-table").html("");
                $.ajax({
                    url: 'http://localhost:3000/html/homoeopathic/activePatient_api/api-fetch-all.php',
                    type: "GET",
                    dataType: "json",
                    success: function (data) {

                        if (data.status == false) {
                            $("#id-table").append("<tr><td colspan='15'><h2>" + data.message + "</h2></td></tr>")
                        }
                        else {
                            // console.log(data);
                            $.each(data, function (key, value) {

                                $("#id-table").append("<tr>" +
                                    "<td>" + value.patientno + "<td>" +
                                    "<td class='date'>" + value.date + "<td>" +
                                    "<td class='opdno'>" + value.opdno + "<td>" +
                                    "<td>" + value.pname + "</td>" +
                                    "<td><button class='btn-consulting' id='" + value.opdno + "' type='" + value.date + "'>Consulting</button></td>" +
                                    "<td><button class='btn-medicine' id='" + value.opdno + "' type='" + value.date + "'>Medicine</button></td>" +
                                    "<td><button class='btn-lab' id='" + value.opdno + "' type='" + value.date + "'>Lab</button></td>" +
                                    "<td><button class='btn-other' id='" + value.opdno + "' type='" + value.date + "'>Other</button></td>" +
                                    "<td><button class='btn-bill'  id='" + value.opdno + "' type='" + value.date + "' name='" + value.pname + "'>Bill</button></td>" +
                                    "<td><button class='btn-x' id='" + value.opdno + "'' type='" + value.date + "'>X</button></td>" +
                                    "</tr>");

                            });
                        }

                    }
                });
            }
            pageload();

            // on consulting btn click send opdno and date into local storage  
            $(document).on("click", ".btn-consulting", function () {

                $(this).css({'background-color': 'red'})
                // $("#modal").show();
                // var name = $(this).attr("data-uname");

                var opdno = $(this).attr("id");
                var date1 = $(this).attr("type");

                console.log(opdno)
                console.log(date1)
                // console.log(date)
                localStorage.clear()

                localStorage.setItem("opdno", opdno)
                localStorage.setItem("date", date1)
                console.log(localStorage)

                location.href = 'http://localhost:3000/html/homoeopathic/consulting.html'


            });

            // on medicine btn click send opdno and date into local storage  
            $(document).on("click", ".btn-medicine", function () {

                // $("#modal").show();
                // var name = $(this).attr("data-uname");

                var opdno = $(this).attr("id");
                var date1 = $(this).attr("type");

                console.log(opdno)
                console.log(date1)
                // console.log(date)
                localStorage.clear()

                localStorage.setItem("opdno", opdno)
                localStorage.setItem("date", date1)
                console.log(localStorage)

                location.href = 'http://localhost:3000/html/homoeopathic/medicine3.html'


            });

            // on lab btn click send opdno and date into local storage  
            $(document).on("click", ".btn-lab", function () {

                // $("#modal").show();
                // var name = $(this).attr("data-uname");

                var opdno = $(this).attr("id");
                var date1 = $(this).attr("type");

                console.log(opdno)
                console.log(date1)
                // console.log(date)
                localStorage.clear()

                localStorage.setItem("opdno", opdno)
                localStorage.setItem("date", date1)
                console.log(localStorage)

                location.href = 'http://localhost:3000/html/homoeopathic/lab.html'


            });

            // on other btn click send opdno and date into local storage  
            $(document).on("click", ".btn-other", function () {

                // $("#modal").show();
                // var name = $(this).attr("data-uname");

                var opdno = $(this).attr("id");
                var date1 = $(this).attr("type");

                console.log(opdno)
                console.log(date1)
                // console.log(date)
                localStorage.clear()

                localStorage.setItem("opdno", opdno)
                localStorage.setItem("date", date1)
                console.log(localStorage)

                location.href = 'http://localhost:3000/html/homoeopathic/other.html'


            });

            // on bill btn click send opdno and date ,name into local storage  
            $(document).on("click", ".btn-bill", function () {

                // $("#modal").show();
                // var name = $(this).attr("data-uname");

                var opdno = $(this).attr("id");
                var date1 = $(this).attr("type");
                var name1 = $(this).attr("name");

                console.log(opdno)
                console.log(date1)
                console.log(name)
                // console.log(date)
                localStorage.clear()

                localStorage.setItem("opdno", opdno)
                localStorage.setItem("date", date1)
                localStorage.setItem("name", name1)
                console.log(localStorage)

                location.href = 'http://localhost:3000/html/homoeopathic/bill.html'


            });

            // on close btn click clear opdno and date ,name from local storage  
            $(document).on("click", ".btn-x", function () {


                localStorage.clear()

                var opdno = $(this).attr("id");
                var date1 = $(this).attr("type");
                // var name1 = $(this).attr("name");
                var row = this
                // console.log(priceInArr);
                var ObjOpdnoDate = { sopdno: opdno, sdate: date1 };
                var ObjOpdnoDateJson = JSON.stringify(ObjOpdnoDate)

                $.ajax({
                    url: 'http://localhost:3000/html/homoeopathic/activePatient_api/api-change-status.php',
                    type: "POST",
                    data: ObjOpdnoDateJson,
                    success: function (data) {
                        console.log(data)
                        if (data.status == true) {
                            console.log("notworking");
                            alert(data.message);
                        }
                        else {
                           
                            $(row).closest("tr").fadeOut(2000);
                            // alert(data.message)
                            pageload();

                        }
                    }

                })




            });
        });
    </script>
</body>

</html>