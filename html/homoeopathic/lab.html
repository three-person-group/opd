<!DOCTYPE html>

<html>

<head>
   <h2>lab</h2>
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
   <!-- <link rel="stylesheet" href="bill.lab.css"> -->

   <style>
      select {
         appearance: none;
      }


      #autocomplete {
         width: 250px;
         float: left;
         position: relative;
      }

      .testname {
         width: 100%;
         height: 36px;
         font-size: 18px;
         padding: 3px 10px;
         border-radius: 4px;
         /* border: 1px solid #e58940; */
         outline: 0;
         box-sizing: border-box;
         margin-left: -10px;
      }

      .list {
         width: 100%;
         position: absolute;
         border: 1px solid #4d6e87;
         display: none;
         background-color: #4d6e87;
      }

      .list ul {
         list-style: none;
         background: #fff;
         margin: 0;
         padding: 0;
         text-align: left;

      }

      .list ul li {
         padding: 2px 10px;
         cursor: pointer;
      }

      .list ul li:hover {
         background: #d0e4f4;
      }
   </style>

   <link rel="stylesheet" href="medicine.css">

</head>

<body>

   <form class="form" method="post" action="">

      Date: 
      <span for="" id="date"></span><br>
      Opdno: 
      <span for="" id="opdno"></span><br>
      Name: 
      <span for="" id="name">name</span><br>
      <br>

      <div>
         <!-- <label>
            lab Name:
         </label> -->
         <div id="autocomplete">
            <input type="text" name="stestname1" id="id-lab-1" class="testname" placeholder="lab Name"
               autocomplete="false">
            <div id="testlist1" class="list" style="z-index: 1"></div>
         </div>


         <input type="number" placeholder="Qty" id="id-qty-1" class="qty" name="sqty1">


         <input id="id-charges-1" class="ipt-charges" name="scharges1" placeholder="Price"></input>
         <br>
         <br>



      </div>
      <div>
         <!-- <label>
            lab Name:
         </label> -->
         <div id="autocomplete">
            <input type="text" name="stestname2" id="id-lab-2" class="testname" placeholder="lab Name"
               autocomplete="false">
            <div id="testlist2" class="list" style="z-index: 1"></div>
         </div>


         <input type="number" placeholder="Qty" id="id-qty-2" class="qty" name="sqty2">


         <input id="id-charges-2" class="ipt-charges" name="scharges2" placeholder="Price"></input>
         <br>


      </div>
      <br>
      <div>
         <!-- <label>
            lab Name:
         </label> -->
         <div id="autocomplete">
            <input type="text" name="stestname3" id="id-lab-3" class="testname" placeholder="lab Name"
               autocomplete="false">
            <div id="testlist3" class="list" style="z-index: 1"></div>
         </div>


         <input type="number" placeholder="Qty" id="id-qty-3" class="qty" name="sqty3">


         <input id="id-charges-3" class="ipt-charges" name="scharges3" placeholder="Price"></input>
         <br>

      </div>
      <br>

      <div>
         <testel>
            <!-- Medicine Name: -->
         </testel>
         <div id="autocomplete">
            <input type="text" id="id-lab-4" class="testname" name="stestname4" placeholder="test Name"
               autocomplete="false">
            <div id="testlist4" class="list" style="z-index: 1"></div>
         </div>


         <input type="number" placeholder="Qty" id="id-qty-4" class="qty" name="sqty4">

         <input id="id-charges-4" class="ipt-charges" placeholder="Price" name="scharges4"></input>
         <br>
         <br>

      </div>

      <div>
         <testel>
            <!-- lab Name: -->
         </testel>
         <div id="autocomplete">
            <input type="text" id="id-lab-5" class="testname" name="stestname5" placeholder="test Name"
               autocomplete="false">
            <div id="testlist5" class="list" style="z-index: 1"></div>
         </div>


         <input type="number" placeholder="Qty" id="id-qty-5" class="qty" name="sqty5">

         <input id="id-charges-5" class="ipt-charges" placeholder="Price" name="scharges5"></input>
         <br>
         <br>

      </div>

      <div>
         <testel>
            <!-- test Name: -->
         </testel>
         <div id="autocomplete">
            <input type="text" id="id-lab-6" class="testname" name="stestname6" placeholder="test Name"
               autocomplete="false">
            <div id="testlist6" class="list" style="z-index: 1"></div>
         </div>


         <input type="number" placeholder="Qty" id="id-qty-6" class="qty" name="sqty6">

         <input id="id-charges-6" class="ipt-charges" placeholder="Price" name="scharges6"></input>
         <br>
         <br>

      </div>


      </div>
      <br>
      <span id="">no :
      </span>
      <input id="totalno" value="0"></input>
      <span id="">qty :
      </span>
      <input id="totalqty" value="0"></input>
      <span id="">Total :
      </span>
      <input id="total" value="0"></input>
      <br><br>

      <button class="btn" role="button" type="submit" id="id-btnsub" name="Submit">Submit</button>

   </form>

   <script>

      $(document).ready(function () {

         //for opdno and date
         var opdno = localStorage.getItem('opdno')  //"107"
         opdno = parseInt(opdno)
         var date1 = localStorage.getItem('date')    //"2022-03-04"
         var name1 = localStorage.getItem('name')    //"2022-03-04"


         $("#date").text(date1);
         $("#opdno").text(opdno);
         $("#name").text(name1);

         // for id1 lab name auto seach click and blur event
         $("#id-lab-1").on("keyup", testname1)


         // for id2 lab name auto seach click and blur event
         $("#id-lab-2").on("keyup", testname2);

         // for id3 lab name auto seach click and blur event
         $("#id-lab-3").on("keyup", testname3);
         $("#id-lab-4").on("keyup", testname4);
         $("#id-lab-5").on("keyup", testname5);
         $("#id-lab-6").on("keyup", testname6);

         // when focus on charges class
         // $(document).on("blur", "#id-charges-1", charge1)
         // $(document).on("blur", "#id-charges-2", charge2)
         // $(document).on("blur", "#id-charges-3", charge3);



         // to get data from lab table in charges field on foucus
         function charge1() {
            $("#id-charges-1").html("");

            var lab_name = $("#id-lab-1").val();
            var obj = { slab_name: lab_name };
            var jsonname = JSON.stringify(obj)

            $.ajax({
               url: 'http://localhost:3000/html/homoeopathic/lab_api/api-fetch-one.php',
               type: "POST",
               data: jsonname,
               success: function (data) {

                  var db = (JSON.parse(data));
                  // console.log(db);


                  if (data.status == false) {
                     $("#id-charges-1").val("Cant Fetch");
                  }
                  else {
                     $("#id-charges-1").val(db[0].CHARGES);
                     no();
                     qty();
                     totalCharges();


                  }
               }
            });

         }

         function charge2() {
            $("#id-charges-2").html("");

            var lab_name = $("#id-lab-2").val();
            var obj = { slab_name: lab_name };
            var jsonname = JSON.stringify(obj)

            $.ajax({
               url: 'http://localhost:3000/html/homoeopathic/lab_api/api-fetch-one.php',
               type: "POST",
               data: jsonname,
               success: function (data) {

                  var db = (JSON.parse(data));
                  // console.log(db);


                  if (data.status == false) {
                     $("#id-charges-2").val("Cant Fetch");
                  }
                  else {
                     $("#id-charges-2").val(db[0].CHARGES);
                     no();
                     qty();
                     totalCharges();

                  }
               }
            });
         }

         function charge3() {
            $("#id-charges-3").html("");

            var lab_name = $("#id-lab-3").val();
            var obj = { slab_name: lab_name };
            var jsonname = JSON.stringify(obj)

            $.ajax({
               url: 'http://localhost:3000/html/homoeopathic/lab_api/api-fetch-one.php',
               type: "POST",
               data: jsonname,
               success: function (data) {

                  var db = (JSON.parse(data));
                  // console.log(db);


                  if (data.status == false) {
                     $("#id-charges-3").val("Cant Fetch");
                  }
                  else {
                     $("#id-charges-3").val(db[0].CHARGES);
                     no();
                     qty();
                     totalCharges();

                  }
               }
            });

         }

         
         function charge4() {
            $("#id-charges-4").html("");

            var lab_name = $("#id-lab-4").val();
            var obj = { slab_name: lab_name };
            var jsonname = JSON.stringify(obj)

            $.ajax({
               url: 'http://localhost:3000/html/homoeopathic/lab_api/api-fetch-one.php',
               type: "POST",
               data: jsonname,
               success: function (data) {

                  var db = (JSON.parse(data));
                  // console.log(db);


                  if (data.status == false) {
                     $("#id-charges-4").val("Cant Fetch");
                  }
                  else {
                     $("#id-charges-4").val(db[0].CHARGES);
                     no();
                     qty();
                     totalCharges();


                  }
               }
            });

         }


         function charge5() {
            $("#id-charges-5").html("");

            var lab_name = $("#id-lab-5").val();
            var obj = { slab_name: lab_name };
            var jsonname = JSON.stringify(obj)

            $.ajax({
               url: 'http://localhost:3000/html/homoeopathic/lab_api/api-fetch-one.php',
               type: "POST",
               data: jsonname,
               success: function (data) {

                  var db = (JSON.parse(data));
                  // console.log(db);


                  if (data.status == false) {
                     $("#id-charges-5").val("Cant Fetch");
                  }
                  else {
                     $("#id-charges-5").val(db[0].CHARGES);
                     no();
                     qty();
                     totalCharges();


                  }
               }
            });

         }


         function charge6() {
            $("#id-charges-6").html("");

            var lab_name = $("#id-lab-6").val();
            var obj = { slab_name: lab_name };
            var jsonname = JSON.stringify(obj)

            $.ajax({
               url: 'http://localhost:3000/html/homoeopathic/lab_api/api-fetch-one.php',
               type: "POST",
               data: jsonname,
               success: function (data) {

                  var db = (JSON.parse(data));
                  // console.log(db);


                  if (data.status == false) {
                     $("#id-charges-6").val("Cant Fetch");
                  }
                  else {
                     $("#id-charges-6").val(db[0].CHARGES);
                     no();
                     qty();
                     totalCharges();


                  }
               }
            });

         }





         function testname1() {
            $("#testlist1").html("");               //empty search list
            var lab_name = $(this).val();


            if (lab_name != "") {
               $.ajax({
                  url: 'http://localhost:3000/html/homoeopathic/lab_api/api-search.php?slab_name=' + lab_name,
                  type: "GET",
                  dataType: "json",
                  success: function (data) {
                     console.log(data)

                     if (data.status == false) {
                        $("#table-id").fadeIn("fast").append("<ul>" +
                           "<li>" + "NOT FOUND" + "</li>" + "</ul>")
                     }
                     else {

                        //dropdown  type search
                        $.each(data, function (key, value) {
                           $("#testlist1").fadeIn("fast").append("<ul>" +
                              "<li>" + value.TESTNAME + "</li>" + "</ul>");
                        });
                     }
                  }
               });
               $("#id-lab-1").focusout(("#testlist1").fadeOut);
            }
            else {
               $("#testlist1").fadeOut();
               $("#id-qty-1").html("");
               $("#id-charges-3").html("");

            }
         }

         //  tab to get first li value in field
         $(document).on("blur", "#id-lab-1", function () {

            let c = $("#testlist1 ul:first li:nth-child(1)").text();

            if (c != "") {
               $("#id-lab-1").val(c);
            }

            // $("#lablist1 ul:first li:nth-child(1)").text("")
            // var c=$("#lablist1 ul:first li:nth-child(1)").val($(this).text());
            // var c=$("#medicinelist1 ul:first li:nth-child(1)").css("color","green");

            console.log(c)
            $("#testlist1").fadeOut();
            charge1();
            // totalCharges();

         });

         //  click to get li value in field
         $(document).on("click", "#testlist1 li", function () {
            $("#id-lab-1").val($(this).text());
            $("#testlist1").fadeOut();
            charge1();
            // totalCharges();

         });

         // fadeOut search list
         $(document).on("blur", "#id-lab-1", function () {
            $("#testlist1").fadeOut();
         });

         // on blur qty having 1
         $("#id-lab-1").change(function () {
            $("#id-qty-1").val(1);
         });

         //idea onfocus chages  qty*chages
         $("#id-charges-1").on("focus", function () {
            var qty = $("#id-qty-1").val()
            console.log(qty)
            const ch = $("#id-charges-1").val()
            console.log(ch)
            if (qty != "") {
               var t = qty * ch;
               $("#id-charges-1").val(t)
            }
         })




         function testname2() {
            $("#testlist2").html("");               //empty search list
            var lab_name = $(this).val();


            if (lab_name != "") {
               $.ajax({
                  url: 'http://localhost:3000/html/homoeopathic/lab_api/api-search.php?slab_name=' + lab_name,
                  type: "GET",
                  dataType: "json",
                  success: function (data) {
                     console.log(data)

                     if (data.status == false) {
                        $("#table-id").fadeIn("fast").append("<ul>" +
                           "<li>" + "NOT FOUND" + "</li>" + "</ul>")
                     }
                     else {

                        //dropdown  type search
                        $.each(data, function (key, value) {
                           $("#testlist2").fadeIn("fast").append("<ul>" +
                              "<li>" + value.TESTNAME + "</li>" + "</ul>");
                        });
                     }
                  }
               });
               $("#id-lab-2").focusout(("#testlist").fadeOut);
            }
            else {
               $("#testlist2").fadeOut();

            }
         }

         $(document).on("blur", "#id-lab-2", function () {
            let c = $("#testlist2 ul:first li:nth-child(1)").text();

            if (c != "") {
               $("#id-lab-2").val(c);
            }

            console.log(c)
            $("#testlist2").fadeOut();
            charge2();
            // totalCharges();

         });

         $(document).on("click", "#testlist2 li", function () {
            $("#id-lab-2").val($(this).text());
            $("#testlist2").fadeOut();
            charge2();
            // totalCharges();

         });
         $(document).on("blur", "#id-lab-2", function () {
            $("#testlist2").fadeOut();
         });

         $("#id-lab-2").change(function () {
            $("#id-qty-2").val(1)
         });
         $("#id-charges-2").on("focus", function () {
            var qty = $("#id-qty-2").val()
            const ch = $("#id-charges-2").val()
            if (qty != "") {
               var t = qty * ch;
               $("#id-charges-2").val(t)
            }
         })


         function testname3() {
            $("#testlist3").html("");               //empty search list
            var lab_name = $(this).val();


            if (lab_name != "") {
               $.ajax({
                  url: 'http://localhost:3000/html/homoeopathic/lab_api/api-search.php?slab_name=' + lab_name,
                  type: "GET",
                  dataType: "json",
                  success: function (data) {
                     console.log(data)

                     if (data.status == false) {
                        $("#table-id").fadeIn("fast").append("<ul>" +
                           "<li>" + "NOT FOUND" + "</li>" + "</ul>")
                     }
                     else {

                        //dropdown  type search
                        $.each(data, function (key, value) {
                           $("#testlist3").fadeIn("fast").append("<ul>" +
                              "<li>" + value.TESTNAME + "</li>" + "</ul>");
                        });
                     }
                  }
               });
               $("#id-lab-3").focusout(("#testlist").fadeOut);
            }
            else {
               $("#testlist3").fadeOut();

            }
         }

         $(document).on("blur", "#id-lab-3", function () {
            let c = $("#testlist3 ul:first li:nth-child(1)").text();

            if (c != "") {
               $("#id-lab-3").val(c);
            }

            console.log(c)
            $("#testlist3").fadeOut();
            charge3();
            // totalCharges();

         });

         $(document).on("click", "#testlist3 li", function () {
            $("#id-lab-3").val($(this).text());
            $("#testlist3").fadeOut();
            charge3();
            // totalCharges();

         });
         $(document).on("blur", "#id-lab-3", function () {
            $("#testlist3").fadeOut();

         });

         $("#id-lab-3").change(function () {
            $("#id-qty-3").val(1)
         });
         $("#id-charges-3").on("focus", function () {
            var qty = $("#id-qty-3").val()
            const ch = $("#id-charges-3").val()
            if (qty != "") {
               var t = qty * ch;
               $("#id-charges-3").val(t)
            }
         })


         
         function testname4() {
            $("#testlist4").html("");               //empty search list
            var lab_name = $(this).val();


            if (lab_name != "") {
               $.ajax({
                  url: 'http://localhost:3000/html/homoeopathic/lab_api/api-search.php?slab_name=' + lab_name,
                  type: "GET",
                  dataType: "json",
                  success: function (data) {
                     console.log(data)

                     if (data.status == false) {
                        $("#table-id").fadeIn("fast").append("<ul>" +
                           "<li>" + "NOT FOUND" + "</li>" + "</ul>")
                     }
                     else {

                        //dropdown  type search
                        $.each(data, function (key, value) {
                           $("#testlist4").fadeIn("fast").append("<ul>" +
                              "<li>" + value.TESTNAME + "</li>" + "</ul>");
                        });
                     }
                  }
               });
               $("#id-lab-4").focusout(("#testlist").fadeOut);
            }
            else {
               $("#testlist4").fadeOut();

            }
         }
         $(document).on("blur", "#id-lab-4", function () {
            let c = $("#testlist4 ul:first li:nth-child(1)").text();

            if (c != "") {
               $("#id-lab-4").val(c);
            }
            console.log(c)
            $("#testlist4").fadeOut();
            charge4();
            // totalCharges();
         });
         $(document).on("click", "#testlist4 li", function () {
            $("#id-lab-4").val($(this).text());
            $("#testlist4").fadeOut();
            charge4();
            // totalCharges();

         });
         $(document).on("blur", "#id-lab-4", function () {
            $("#testlist4").fadeOut();

         });
         $("#id-lab-4").change(function () {
            $("#id-qty-4").val(1)
         });
         $("#id-charges-4").on("focus", function () {
            var qty = $("#id-qty-4").val()
            console.log(qty)
            const ch = $("#id-charges-4").val()
            console.log(ch)
            if (qty != "") {
               var t = qty * ch;
               $("#id-charges-4").val(t)
            }
         })
         $("#id-charges-4").on("blur", function () {
            // no();
            qty();
         });


         function testname5() {
            $("#testlist5").html("");               //empty search list
            var lab_name = $(this).val();


            if (lab_name != "") {
               $.ajax({
                  url: 'http://localhost:3000/html/homoeopathic/lab_api/api-search.php?slab_name=' + lab_name,
                  type: "GET",
                  dataType: "json",
                  success: function (data) {
                     console.log(data)

                     if (data.status == false) {
                        $("#table-id").fadeIn("fast").append("<ul>" +
                           "<li>" + "NOT FOUND" + "</li>" + "</ul>")
                     }
                     else {

                        //dropdown  type search
                        $.each(data, function (key, value) {
                           $("#testlist5").fadeIn("fast").append("<ul>" +
                              "<li>" + value.TESTNAME + "</li>" + "</ul>");
                        });
                     }
                  }
               });
               $("#id-lab-5").focusout(("#testlist").fadeOut);
            }
            else {
               $("#testlist5").fadeOut();

            }
         }
         $(document).on("blur", "#id-lab-5", function () {
            let c = $("#testlist5 ul:first li:nth-child(1)").text();

            if (c != "") {
               $("#id-lab-5").val(c);
            }
            console.log(c)
            $("#testlist5").fadeOut();
            charge5();
            // totalCharges();
         });
         $(document).on("click", "#testlist5 li", function () {
            $("#id-lab-5").val($(this).text());
            $("#testlist5").fadeOut();
            charge5();
            // totalCharges();

         });
         $(document).on("blur", "#id-lab-5", function () {
            $("#testlist5").fadeOut();

         });
         $("#id-lab-5").change(function () {
            $("#id-qty-5").val(1)
         });
         $("#id-charges-5").on("focus", function () {
            var qty = $("#id-qty-5").val()
            console.log(qty)
            const ch = $("#id-charges-5").val()
            console.log(ch)
            if (qty != "") {
               var t = qty * ch;
               $("#id-charges-5").val(t)
            }
         })
         $("#id-charges-5").on("blur", function () {
            // no();
            qty();
         });


         function testname6() {
            $("#testlist6").html("");               //empty search list
            var lab_name = $(this).val();


            if (lab_name != "") {
               $.ajax({
                  url: 'http://localhost:3000/html/homoeopathic/lab_api/api-search.php?slab_name=' + lab_name,
                  type: "GET",
                  dataType: "json",
                  success: function (data) {
                     console.log(data)

                     if (data.status == false) {
                        $("#table-id").fadeIn("fast").append("<ul>" +
                           "<li>" + "NOT FOUND" + "</li>" + "</ul>")
                     }
                     else {

                        //dropdown  type search
                        $.each(data, function (key, value) {
                           $("#testlist6").fadeIn("fast").append("<ul>" +
                              "<li>" + value.TESTNAME + "</li>" + "</ul>");
                        });
                     }
                  }
               });
               $("#id-lab-6").focusout(("#testlist").fadeOut);
            }
            else {
               $("#testlist6").fadeOut();

            }
         }
         $(document).on("blur", "#id-lab-6", function () {
            let c = $("#testlist6 ul:first li:nth-child(1)").text();

            if (c != "") {
               $("#id-lab-6").val(c);
            }
            console.log(c)
            $("#testlist6").fadeOut();
            charge6();
            // totalCharges();
         });
         $(document).on("click", "#testlist6 li", function () {
            $("#id-lab-6").val($(this).text());
            $("#testlist6").fadeOut();
            charge6();
            // totalCharges();

         });
         $(document).on("blur", "#id-lab-6", function () {
            $("#testlist6").fadeOut();

         });
         $("#id-lab-6").change(function () {
            $("#id-qty-6").val(1)
         });
         $("#id-charges-6").on("focus", function () {
            var qty = $("#id-qty-6").val()
            console.log(qty)
            const ch = $("#id-charges-6").val()
            console.log(ch)
            if (qty != "") {
               var t = qty * ch;
               $("#id-charges-6").val(t)
            }
         })
         $("#id-charges-6").on("blur", function () {
            // no();
            qty();
         });




         //for total medicne


         //for total medicne
         function totalCharges() {
            var ch1 = $("#id-charges-1").val()
            var ch2 = $("#id-charges-2").val()
            var ch3 = $("#id-charges-3").val()
            var ch4 = $("#id-charges-4").val()
            var ch5 = $("#id-charges-5").val()
            var ch6 = $("#id-charges-6").val()
            if (ch1 != "") { ch1 = parseInt(ch1); }
            if (ch2 != "") { ch2 = parseInt(ch2); }
            if (ch3 != "") { ch3 = parseInt(ch3); }
            if (ch4 != "") { ch4 = parseInt(ch4); }
            if (ch5 != "") { ch5 = parseInt(ch5); }
            if (ch6 != "") { ch6 = parseInt(ch6); }
            console.log(ch1)
            console.log(ch2)

            var total1 = ch1 + ch2 + ch3 + ch4 + ch5 + ch6;
            // console.log(total)
            // console.log(typeof(total))
            $("#total").val(total1)
            // console.log($(".total").text())

         }

         //change from change to blur event
         $(".ipt-charges").on("blur", function () {
            var ch1 = $("#id-charges-1").val()
            var ch2 = $("#id-charges-2").val()
            var ch3 = $("#id-charges-3").val()
            var ch4 = $("#id-charges-4").val()
            var ch5 = $("#id-charges-5").val()
            var ch6 = $("#id-charges-6").val()
            if (ch1 != "") { ch1 = parseInt(ch1); }
            if (ch2 != "") { ch2 = parseInt(ch2); }
            if (ch3 != "") { ch3 = parseInt(ch3); }
            if (ch4 != "") { ch4 = parseInt(ch4); }
            if (ch5 != "") { ch5 = parseInt(ch5); }
            if (ch6 != "") { ch6 = parseInt(ch6); }
            console.log(ch1)
            console.log(ch2)

            var total1 = ch1 + ch2 + ch3 + ch4 + ch5 + ch6;
            // console.log(total)
            // console.log(typeof(total))
            $("#total").val(total1)
            // console.log($(".total").text())
         });

         $(".testname").on("blur", function () {
            no();
         })

         function no() {
            var totalno = 0;
            $('.testname').each(function (index, value) {
               console.log(`${this.value}`);
               var medi = this.value;
               if (medi != "") {
                  totalno = totalno + 1
               }

            });
            console.log(totalno)
            $("#totalno").val(totalno)

         }

         $(".qty").on("blur", function () {
            qty();
         })

         function qty() {
            var totalqty = 0;
            $('.qty').each(function (index, value) {
               console.log(`${this.value}`);
               var qtyno = this.value;
               if (qtyno != "") {
                  totalqty = totalqty + parseInt(qtyno)
               }

            });
            console.log(totalqty)
            $("#totalqty").val(totalqty)

         }





         $("#id-btnsub").on("click", btnclick())
         // insert data1
         function btnclick() {

            $("#id-btnsub").on("click", function (e) {
               e.preventDefault();


               var arr = $(".testname").serializeArray();

               var objArr = {};

               for (let i = 0; i < arr.length; i++) {
                  if (arr[i].value == '') {
                     // alert("fill all filed");
                     // return false;
                     arr[i].name = "";
                     // delete arr[i];
                     // arr.length = arr.length - 1;
                  } else {
                     objArr[arr[i].name] = arr[i].value;
                  }
               }

               console.log(objArr);
               var testInArr = Object.values(objArr);   //array
               testInArr = JSON.stringify(testInArr)

               console.log(testInArr);
               arrObjtest = { stestarr: testInArr };
               arryObjtestJson = JSON.stringify(arrObjtest)


               //// for qty fild

               var qtyarr = $(".qty").serializeArray();

               var qtyobjArr = {};

               for (let i = 0; i < qtyarr.length; i++) {
                  if (qtyarr[i].value == '') {
                     // alert("fill all filed");
                     // return false;
                     qtyarr[i].name = "";
                     // delete qtyarr[i];
                     // qtyarr.length = qtyarr.length - 1;
                  } else {
                     qtyobjArr[qtyarr[i].name] = qtyarr[i].value;
                  }
               }
               console.log(qtyobjArr);
               var qtyInArr = Object.values(qtyobjArr);
               qtyInArr = JSON.stringify(qtyInArr)

               console.log(qtyInArr);
               arrObjqty = { sqtyarr: qtyInArr };
               arrObjqtyJson = JSON.stringify(arrObjqty);

               //for price


               var pricearr = $(".ipt-charges").serializeArray();

               var priceobjArr = {};
               for (let i = 0; i < pricearr.length; i++) {
                  if (pricearr[i].value == '') {
                     // alert("fill all filed");
                     // return false;
                     pricearr[i].name = "";
                     // delete pricearr[i];
                     // pricearr.length = pricearr.length - 1;
                  } else {
                     priceobjArr[pricearr[i].name] = pricearr[i].value;
                  }
               }
               console.log(priceobjArr);
               var priceInArr = Object.values(priceobjArr);
               priceInArr = JSON.stringify(priceInArr)

               console.log(priceInArr);
               arrObjPrice = { spricearr: priceInArr };
               arrObjPriceJson = JSON.stringify(arrObjPrice)



               //for opdno and date
               var opdno = localStorage.getItem('opdno')  //"107"
               opdno = parseInt(opdno)
               var date1 = localStorage.getItem('date')    //"2022-03-04"

               var obj1 = { sopdno: opdno, sdate: date1 };
               console.log(obj1);

               var finalResult = Object.assign(objArr, qtyobjArr, obj1);
               console.log(finalResult)
               var jsonname2 = JSON.stringify(finalResult)



               $.ajax({
                  url: 'http://localhost:3000/html/homoeopathic/lab_api/api-insert.php',
                  type: "post",
                  data: jsonname2,
                  success: function (data) {
                     if (data.status == true) {
                        // alert(data.message)
                        // pageload()
                        console.log("working");
                     }
                     else {
                        console.log("notworking");
                        // alert(data.message);

                     }
                  }
               })




               var finalResultmedicine = Object.assign(arrObjtest, obj1);
               var finalResultmedicineJson = JSON.stringify(finalResultmedicine)
               console.log(finalResultmedicineJson)

               // insert //medicine//,qty,price into homo_bill in array form
               $.ajax({
                  url: 'http://localhost:3000/html/homoeopathic/lab_api/api-insert-in-bill-lab-in-array.php',
                  type: "POST",
                  data: finalResultmedicineJson,
                  success: function (data) {
                     console.log(data)
                     if (data.status == true) {
                        // alert(data.message)
                     }
                     else {
                        console.log("notworking");
                        // alert(data.message);

                     }
                  }
               })


               var finalResultqty = Object.assign(arrObjqty, obj1);
               var finalResultqtyJson = JSON.stringify(finalResultqty)
               console.log(finalResultqtyJson)

               // insert medicine,//qty//,price into homo_bill in array form
               $.ajax({
                  url: 'http://localhost:3000/html/homoeopathic/lab_api/api-insert-in-bill-qty-in-array.php',
                  type: "POST",
                  data: finalResultqtyJson,
                  success: function (data) {
                     console.log(data)
                     if (data.status == true) {
                        // alert(data.message)
                     }
                     else {
                        console.log("notworking");
                        // alert(data.message);

                     }
                  }
               })


               var finalResultPrice = Object.assign(arrObjPrice, obj1);
               var finalResultPriceJson = JSON.stringify(finalResultPrice)
               finalResultPriceJson = JSON.stringify(finalResultPrice)
               console.log(finalResultPriceJson)


               // insert medicine,qty,//price// into homo_bill in array form
               $.ajax({
                  url: 'http://localhost:3000/html/homoeopathic/lab_api/api-insert-in-bill-price-in-array.php',
                  type: "POST",
                  data: finalResultPriceJson,
                  success: function (data) {
                     console.log(data)
                     if (data.status != false) {
                        // alert(data.message)
                     }
                     else {
                        console.log("notworking");
                        // alert(data.message);

                     }
                  }
               })


               var totalnoinsert = $("#totalno").val();
               var totalqtyinsert = $("#totalqty").val();
               var totalinsert = $("#total").val();
               var objtotal = { stotal: totalinsert, stotalqty: totalqtyinsert, stotalno: totalnoinsert };
               console.log(obj1);
               var finaltotal = Object.assign(objtotal, obj1);
               finaltotal = JSON.stringify(finaltotal)

               // inserting noOfMedicine qtyOfMedicine totalOfMedicine

               $.ajax({
                  url: 'http://localhost:3000/html/homoeopathic/lab_api/api-insert-total-lab-price.php',
                  type: "POST",
                  data: finaltotal,
                  success: function (data) {
                     console.log(data)
                     if (data.status != false) {
                        // alert(data.message)
                     }
                     else {
                        console.log("notworking");
                        // alert(data.message);

                     }
                  }
               })

               ////inserting total into inv. lab to total med/// also in other
               $.ajax({
                  url: 'http://localhost:3000/html/homoeopathic/lab_api/api-insert-total-lab-price-in-inventory.php',
                  type: "POST",
                  data: finaltotal,
                  success: function (data) {
                     console.log(data)
                     if (data.status == true) {
                        // alert(data.message)
                     }
                     else {
                        console.log("notworking");
                        // alert(data.message);

                     }
                  }
               })




               location.href = 'http://localhost:3000/html/homoeopathic/patient_process.html';

            })

         }


      });


   </script>

</body>

</html>


<!-- test_qty
test_charges
test_total -->